<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>drawio-FC</title>
    <!-- css-1rd -->
    <style>
      body {
        margin: 0px;
      }
    </style>
    <!-- css-3rd -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/material-icons@1.11.11/iconfont/material-icons.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/material-components-web@14.0.0/dist/material-components-web.min.css"
    />
    <link
      rel="stylesheet"
      data-name="vs/editor/editor.main"
      href="https://unpkg.com/monaco-editor@0.33.0/min/vs/editor/editor.main.css"
    />
  </head>

  <body>
    <header class="mdc-top-app-bar">
      <div class="mdc-top-app-bar__row">
        <section
          class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start"
        >
          <button
            class="material-icons mdc-top-app-bar__navigation-icon mdc-icon-button"
            aria-label="Close"
          >
            auto_fix_high
          </button>
          <span class="mdc-top-app-bar__title"
            >drawio-FC（根据预设生成图形集）</span
          >
        </section>
        <section
          class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end"
          role="toolbar"
        >
          <button
            class="material-icons mdc-top-app-bar__action-item mdc-icon-button"
            aria-label="Share"
          >
            share
          </button>
          <button
            class="material-icons mdc-top-app-bar__action-item mdc-icon-button"
            aria-label="Delete"
          >
            delete
          </button>
          <button
            class="material-icons mdc-top-app-bar__action-item mdc-icon-button"
            aria-label="Open menu"
          >
            more_vert
          </button>
        </section>
      </div>
    </header>
    <main class="mdc-top-app-bar--fixed-adjust">
      <!-- 布局mdc-layout-grid ... -->
      <div class="mdc-layout-grid">
        <div class="mdc-layout-grid__inner">
          <div
            class="mdc-layout-grid__cell mdc-layout-grid__cell--align-middle"
            style="text-align: center"
          >
            <img
              src="data:image/webp;base64,UklGRu4DAABXRUJQVlA4IOIDAADQIgCdASp5AMkAPoE4mUelI7+hJZR86/AQCWlu3WBpKh+kv8d/CDwG/vHQu+NPXLOK/Rr9V/Os9h/jPxm8ADvCqd/YB6kfzH+5/aX5sX6T3mvMP/2PofxgH8c/uf/A9Ez+6/uv5Ve1P8m/tv/Q/vHwE/yf+cf8X+5f3fiPQ1mtww2WJLGRDh930fON4iysUQop+PvclptRQFIzZnqTlUrY75Ij5yehBEdZcKZX3huKlWwZnRXRMFct0sC/TOqasebz3M+koImJQB0n2lOnKiW7DTQHnmLoBd2kMretHBOuTUpLRn3Bj57G0OGh9sl5Wq16dw2VnntQZEeFN4kri1HvtRJKkgHfjpWDD9bHnsoqZHkAY05zkIyOr4h5xXikAAD0Au9BFd++5ipNoYGsQiXJHr0EczjrGaTiJZimReWOM+bxyM1capHAXFG1Fm4Q5BCnRp2maWTIUqak3sps/vQ5DHz7hKabbx8Ovsc77AyXFPB/N+FvBE/gYy0JMabKrF5DFHWQzdSC5sUbBOwV0Qm8+9Ok7XB6j1H4mAmbyqSYrf1YuekL/in+VM/P+3ScXIp/OqTi2SZoz4sbKBKWKkNa1fotR8iasv1wilqyiqLCiP7Phfg5bamW5HR6ZkTR81noCMzyKuKx7GZV9nW5Rz09Yqp4cqttYuBP02Lf5vjheZCVzu7/uf79IxA3mRIJG4AHdHRUYBBBu5dhRbjKQeKf36t0okXy2ecYDW7K5rA+NuT0LGpLnpdZgswW7BrOWpVNUgiUAaHNHNvKdOfkJHz866UxirICKT2AxsHyRmzB3vPN3DfNYurmkvk0c8Y8tfzxXRitAtVcbDzfaJKbfayuVoCvwblt3bsjduRRqJ3j4P5vwt4In8DGWhJjTZVYvIYo6yGbqQXNijYJ2G+Tk8jXgFD2OM3VsepLVJbJfNEPLeOJN5BR5f/+OfuIrYPmefXQSm/EACjUdaS7pNpZKJhp9G///zp3/+dx///OKN3yHHEfIdt2/Hx557k1FOVBxfZ/foqmBUHrLhE7hfgMh4D7yjLZGoO5YW8sEwzU7X57fc/kVIiSdhi/mAQfTdkb6Kidkur49b90/JJxWnJcIfNy+8B64e695i9zSR4a8s2zQJKAuXnu/yndwTsa3SZVj0hpq8UVfNItFxP8aQO/Wl8Dun0fGwKIhE8U4+0R1FYg56ZTh4Cf8Cj66TEbi9SjU/NQbgc+pKtaXoM+5b8z5NE6ScCE9NEhi7WzB5fsmj3hZhdkV31rG/ozQaWlr+c0OV2eIRx7Pg0+E1gmYqAO2SPbL+qrZrhM6KxwJF9KPviAAAAA"
            />
          </div>
          <div class="mdc-layout-grid__cell">
            <!-- 卡片mdc-card ... -->
            <div class="mdc-card mdc-card--outlined">
              <!-- ... content ... -->
              <p>浏览器提交预设，函数计算，返回图形集，图形集保存在阿里云OSS。</p>
            </div>
          </div>
          <div class="mdc-layout-grid__cell">
            <form method="POST" action="/">
              <!-- Render textfield component -->
              <label
                class="mdc-text-field mdc-text-field--filled"
                style="width: 80%"
              >
                <span class="mdc-text-field__ripple"></span>
                <span class="mdc-floating-label" id="my-label"
                  >初始值，value：</span
                >
                <input
                  type="text"
                  class="mdc-text-field__input"
                  aria-labelledby="my-label"
                  id="value"
                  name="value"
                />
                <span class="mdc-line-ripple"></span>
              </label>

              <!-- Render textfield component -->
              <label
                class="mdc-text-field mdc-text-field--filled"
                style="width: 80%"
              >
                <span class="mdc-text-field__ripple"></span>
                <span class="mdc-floating-label" id="my-label"
                  >矩形总个数，number：</span
                >
                <input
                  type="text"
                  class="mdc-text-field__input"
                  aria-labelledby="my-label"
                  id="number"
                  name="number"
                />
                <span class="mdc-line-ripple"></span>
              </label>

              <!--
              <button type="submit">确定</button>
              -->
            </form>
            <button class="mdc-button mdc-button--raised" id="post1">
              <div class="mdc-button__ripple"></div>
              <i class="material-icons mdc-button__icon" aria-hidden="true"
                >bookmark</i
              >
              <span class="mdc-button__label">确定</span>
            </button>
            <button class="mdc-button mdc-button--raised" id="copy1">
              <div class="mdc-button__ripple"></div>
              <i class="material-icons mdc-button__icon" aria-hidden="true"
                >bookmark</i
              >
              <span class="mdc-button__label">复制</span>
            </button>
          </div>
        </div>
      </div>

      <div
        id="container"
        style="width: 99%; height: 50vh; border: 1px solid grey"
      ></div>
      <!-- 光标行列坐标 -->
      <div id="div-cursor-position" style="width: 100%"></div>
    </main>
    <!-- Required monaco-editor JavaScript library -->
    <script>
      var require = {
        paths: {
          vs: "https://unpkg.com/monaco-editor@0.33.0/min/vs",
        },
      };
    </script>
    <script src="https://unpkg.com/monaco-editor@0.33.0/min/vs/loader.js"></script>
    <script src="https://unpkg.com/monaco-editor@0.33.0/min/vs/editor/editor.main.nls.js"></script>
    <script src="https://unpkg.com/monaco-editor@0.33.0/min/vs/editor/editor.main.js"></script>
    <!-- Required Material Web JavaScript library -->
    <script src="https://unpkg.com/material-components-web@14.0.0/dist/material-components-web.min.js"></script>
  </body>
  <!-- 渲染monaco-editor -->
  <script>
    var editor = monaco.editor.create(document.getElementById("container"), {
      value: "", //初始空值
      language: "xml",
    });

    // 新建一个 div
    var text = document.createElement("DIV");
    text.id = "show-position";
    text.innerHTML = "Ln 1, Col 1";
    var header = document.getElementById("div-cursor-position");
    header.appendChild(text);

    //实时获取光标所在行号和列号
    editor.onDidChangeCursorPosition((e) => {
      document.getElementById("show-position").innerHTML =
        "行" +
        editor.getPosition().lineNumber +
        "列" +
        editor.getPosition().column;
    });
    //resize的时候，重载，自动调整monaco-editor宽度
    window.addEventListener("resize", () => {
      location.reload(true);
    });
  </script>

  <!-- 渲染mdc -->
  <script>
    document.addEventListener("DOMContentLoaded", (event) => {
      console.log("DOM fully loaded and parsed"); // 译者注："DOM 完全加载以及解析"
      const mdc = require("material-components-web");
      const textFields = document.querySelectorAll(".mdc-text-field");
      for (const textField of textFields) {
        mdc.textField.MDCTextField.attachTo(textField);
      }
    });
  </script>

  <script>
    document.querySelector("#post1").addEventListener("click", function () {
      let value = document.querySelector("#value").value;
      let number = document.querySelector("#number").value;
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "https://draw-bot-draw-silcoclnor.cn-shenzhen.fcapp.run");
      xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
          editor.setValue(xhr.responseText); //设置monaco值
        }
      };
      xhr.send(`id=222&value=${value}&number=${number}`);
    });
  </script>
  <script>
    document.querySelector("#copy1").onclick = function () {
      const range = editor.getModel().getFullModelRange();
      editor.setSelection(range);
      editor.focus(); //很有必要
      document.execCommand("copy"); // cut,copy,paste, e.t.c
      //var code = editor.getValue();
    };
  </script>
</html>
